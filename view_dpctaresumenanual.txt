VIS_ACTIVO	.T.VIS_ALTER	.F.VIS_AUTO	.F.VIS_CODADD	 VIS_DEFINE	SELECT  CTA_CODIGO AS BLC_CODIGO, 
 CTA_DESCRI AS BLC_DESCRI, 
 SUM(IF(MOC_MONTO>0,MOC_MONTO   ,0))  AS BLC_MTODEB,
 SUM(IF(MOC_MONTO<0,MOC_MONTO*-1,0))  AS BLC_MTOCRE,
 SUM(MOC_MONTO)  AS BLC_MONTO, 
 SUM(ROUND(IF(MOC_MONTO>0,MOC_MONTO   ,0)/IF(HMN_VALOR IS NULL,0,HMN_VALOR),2)) AS BLC_DEBODIV,
 SUM(ROUND(IF(MOC_MONTO<0,MOC_MONTO*-1,0)/IF(HMN_VALOR IS NULL,0,HMN_VALOR),2)) AS BLC_CREDIV, 
 SUM(ROUND(MOC_MONTO/IF(HMN_VALOR IS NULL,0,HMN_VALOR),2)) AS BLC_MTODIV,
 YEAR(MOC_FECHA) AS BLC_ANO 
 FROM dpcta 
 INNER JOIN dpasientos ON CTA_CODIGO=LEFT(MOC_CUENTA,LENGTH(CTA_CODIGO)) 
 LEFT  JOIN dphismon   ON HMN_CODIGO="DBC" AND HMN_FECHA=MOC_FECHA 
 WHERE MOC_ACTUAL="S" OR MOC_ACTUAL="A" 
 GROUP BY YEAR(MOC_FECHA),CTA_CODIGO 
 ORDER BY YEAR(MOC_FECHA),CTA_CODIGO 
VIS_DSN	<MULTIPLE>VIS_FECHA	04/07/2025VIS_HORA	 VIS_INDICA	.F.VIS_NOMBRE	Cuentas con resultados resumidos por AñoVIS_PRGPRE	 VIS_TABLA	.F.VIS_TABLE	DPCTAVIS_VISTA	DPCTARESUMENANUALVIS_PRGRUN	 